<?php$success = '';$error='';			$crud = new Crud; $id=$_GET['id'];if(isset($_POST['submit'])){	$data = array(		'name'=>$_POST['name'],		'description'=>$_POST['description'],		'parent_category'=>$_POST['parent_category'],		'show_on_budget'=>$_POST['show_on_budget'],		'shop_for_wedding'=>$_POST['shop_for_wedding'],		'image'=>$_FILES["image"]["name"]	);	$fields = array('name','description');	$validation = new Validation;	$message = $validation->check_empty($data,$fields);	if($message == null || $message == ''){		if(!empty($_FILES['image']['name'])){				$target_dir = DIR_IMAGE_SYSTEM.'/category_'.$id.'/';			if(!is_dir($target_dir)){				mkdir($target_dir);			}
			$target_file = $target_dir . basename($_FILES["image"]["name"]);			$image=basename($_FILES["image"]["name"]);			$uploadOk = 1;			$imageFileType = strtolower(pathinfo($target_file,PATHINFO_EXTENSION));			if($imageFileType != "jpg" && $imageFileType != "png" && $imageFileType != "jpeg" && $imageFileType != "gif" ) {				$error =  "Sorry, only JPG, JPEG, PNG & GIF files are allowed.";				$uploadOk = 0;			}	
			if (move_uploaded_file($_FILES["image"]["tmp_name"], $target_file)) {				//$error =  "The file ". basename( $_FILES["image"]["name"]). " has been uploaded.";			} else {				$error =  "Sorry, there was an error uploading your file.";			}			$sql = "update categories set name= '".$_POST['name']."', description= '".$_POST['description']."', meta_description= '".$_POST['meta_description']."', meta_keyword= '".$_POST['meta_keyword']."', parent_category= '".$_POST['parent_category']."', show_on_budget= '".$_POST['show_on_budget']."', shop_for_wedding= '".$_POST['shop_for_wedding']."' , image='$image'  where id ='$id'";		}else{			$sql = "update categories set name= '".$_POST['name']."', description= '".$_POST['description']."', meta_description= '".$_POST['meta_description']."', meta_keyword= '".$_POST['meta_keyword']."', parent_category= '".$_POST['parent_category']."', show_on_budget= '".$_POST['show_on_budget']."', shop_for_wedding= '".$_POST['shop_for_wedding']."' where id ='$id'";		}		$crud->execute($sql);		$success = 'Successfully updated categories';	}else{		$error = $message;	}}if(isset($_GET['id'])){	$sql1 = "Select * from categories where id = $id";	$result1 = $crud->getData($sql1);    if(!empty($result1)){		$user = $result1[0];	}}?>	<div class="wrapper mt-20 mb-20">	<section class="blocks add_category">		<h2>Update Category</h2>		<?php  		echo isset($success) && !empty($success) ? "<div class='alert alert-success'>".$success."</div>" : "";		echo isset($error) && !empty($error) ? "<div class='alert alert-danger'>".$error."</div>" : "";		?>
		<form action="" method="post" enctype="multipart/form-data">
			<table class="table-2 mt-20">			<tr>				<td>Name*</td>				<td><input type ="text" name="name" value="<?php echo $user['name'];?>"></td>			</tr>			<tr>				<td>Description</td>				<td><textarea  name="description" cols="30" rows="10"><?php echo $user['description'];?></textarea></td>			</tr>			<tr>				<td>Meta keywords</td>				<td><input type ="text" name="meta_keyword" value="<?php echo $user['meta_keyword'];?>"></td>			</tr>			<tr>				<td>Meta Description</td>				<td><textarea  name="meta_description" cols="30" rows="10"><?php echo $user['meta_description'];?></textarea></td>			</tr>			<tr>				<td>Parent Category</td>				<td>					<select name="parent_category" class="form-control">						<option value="">None</option>						<?php 						$sql="SELECT * from categories where parent_category = 0 or parent_category IS NULL";						$result = $crud->getData($sql);                 						if(!empty($result)){							foreach ($result as $res){								$selected = ($res['id'] == $user['parent_category']) ? 'selected' : '';								echo '<option value="'.$res['id'].'" '.$selected.'>'.$res['name'].'</option>';							}						}						?>					</select>				</td>			</tr>			<tr>				<td>Image*</td>				<td><input type="file" name="image" >					<img src ="<?php echo IMAGE_SITE_URL ?>/category_<?php echo $id.'/'.$user['image'];?>"  alt="" style="max-width:100px;"/>				</td>			</tr>			 <tr>				<td>Set Position for Find Vendors At Your Budget on front</td>				<td>					<select name="show_on_budget" class="form-control">						<option value="">None</option>						<?php 						$sql="SELECT GROUP_CONCAT(show_on_budget) as show_on_budget from categories where show_on_budget >0 and id != '".$user['id']."'";						$result = $crud->getData($sql);    						$setOptions = array();						if(!empty($result)){							$setOptions = explode(',',$result[0]['show_on_budget']);						}						for($i=1;$i<=4;$i++){							if(!in_array($i,$setOptions)){								$selected = ($user['show_on_budget'] == $i) ? 'selected' : "";								echo '<option value="'.$i.'" '.$selected.'>'.$i.'</option>';							}						}												?>					</select>				</td>			</tr>   <tr>				<td>Set Position for Shop For Your Wedding on front</td>				<td>					<select name="shop_for_wedding" class="form-control">						<option value="">None</option>						<?php 						$sql="SELECT GROUP_CONCAT(shop_for_wedding) as shop_for_wedding from categories where shop_for_wedding >0 and id != '".$user['id']."'";						$result = $crud->getData($sql);    						$setOptions = array();						if(!empty($result)){							$setOptions = explode(',',$result[0]['shop_for_wedding']);						}						for($i=1;$i<=4;$i++){							if(!in_array($i,$setOptions)){								$selected = ($user['shop_for_wedding'] == $i) ? 'selected' : "";								echo '<option value="'.$i.'" '.$selected.'>'.$i.'</option>';							}						}												?>					</select>				</td>			</tr>			<tr><td><input type="submit"name="submit" class="btn"></td></tr>			</table>
		</form>	</section></div>

